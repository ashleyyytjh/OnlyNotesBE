stages:
  - trigger
  - notify

trigger_orders:
  stage: trigger
  trigger:
    include: apps/orders/.gitlab-ci.yml
    strategy: depend
  rules:
    - changes:
        - apps/orders/**/*

trigger_account:
  stage: trigger
  trigger:
    include: apps/account/.gitlab-ci.yml
    strategy: depend
  rules:
    - changes:
        - apps/account/**/*

trigger_notes:
  stage: trigger
  trigger:
    include: apps/notes/.gitlab-ci.yml
    strategy: depend
  rules:
    - changes:
        - apps/notes/**/*

trigger_request:
  stage: trigger
  trigger:
    include: apps/request/.gitlab-ci.yml
    strategy: depend
  rules:
    - changes:
        - apps/request/**/*

# trigger_reviews:
#   stage: trigger
#   rules:
#     - changes:
#         - apps/reviews/**/*

trigger_verify:
  stage: trigger
  trigger:
    include: apps/verify/.gitlab-ci.yml
    strategy: depend
  rules:
    - changes:
        - apps/verify/**/*

notify_discord:
  stage: notify
  script:
    - >
      curl -X POST -H "Content-Type: application/json" -d "{\"content\": \"Pipeline Status: $CI_PIPELINE_STATUS\nProject: $CI_PROJECT_NAME\nCommit: $CI_COMMIT_REF_NAME\nCommit message: $CI_COMMIT_MESSAGE\nPipeline URL: $CI_PIPELINE_URL\"}" $DISCORD_WEBHOOK_URL
